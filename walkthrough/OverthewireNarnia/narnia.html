<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">
	<title>Oriyo's Personal Website</title>
	<link rel="stylesheet" href="stylesheet.css" type="text/css">
	<link rel="icon" href="https://oriyocookie.github.io/images/icon2.jpeg">
	<script src="scripts.js"></script>
    </head>
    <div class="top">
	<h1><img src="https://oriyocookie.github.io/images/icon2.jpeg" class="comfy"></img>Oriyo's cool website<img
								       src="https://oriyocookie.github.io/images/icon2.jpeg" class="comfy"></img></h1>
    </div>
    <div class="header">
	<nav class="navbar">
	    <a href="https://oriyocookie.github.io/index.html" title="Go to index"><strong>Home</strong></a>
	    <a href="https://oriyocookie.github.io/configs.html" title="My programs"><strong>My list of configs</strong></a>
	    <div class="dropdown">
		<button class="dropbtn">
		    <strong>My CTF walkthroughs</strong></a>
		</button>
		<div class="dropdown-content">
		    <a href="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/narnia.html">Narnia OverTheWire</a>
		</div>
	    </div>
	    <a href="https://github.com/oriyocookie" title="My github"><strong>Github page</strong></a>
	</nav>
    </div>
    <body>
	<p>Hi, welcome to Oriyo's cool and comfy Narnia walkthroughs. I worked through the Narnia
	game in Overthewire, and after i was done, i made a python script using the pwntools
	library. I just log the details on how i finished the levels. I'll keep the passwords as
	hidden as possible, but obviously if you read the code for the scripts you'll find them
	there. Also I won't post exactly how to solve it and give the commands. You can obviously
	find them if you go through the scripts(So i guess i am kinda giving the answer lul). This is still a work in progress</p>
	<img src="../../images/Touko_NAVI.png" class="intro"></img>
	<p> The format for my walkthrough will be simple. I will briefly go over the code and write
	what i plan on doing to complete the level. Then I shall talk about how I wrote the script
	and what I had to do to write the script. In between all those i'll post pics </p>

	<button class="collapsible"><h3><strong>Level 0 to Level 1</strong></h3></button>
	<div class="content">
	<p class="walkthrough">This one is a fairly simple level. As you can see from the image
	below <br/><p>
	<img src="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/images/narnia0.jpg"
	     class="helpful"></img>
	<p class="walkthrough">There is a value that is initialized at 0x41414141 and you need to
	change it to deadbeef. The buffer can hold a maximum of 20 characters. So in order to
	overflow the buffer and go into changing the value of val, you just need to input 20
	characters and put \xef\xbe\xad\xde\, which is how deadbeef has to be put in because of
	little endianness</p>
	<p class="walkthrough">Making the python script was fairly simple for this too. All you have
	to do is make the ssh connection, execute the file and send the payload which is A*20 + the
	little endian of deadbeef(which can be done very easily by using the p32 command in pwntools). Fortunately for us pwntools allows us to do all those really
	fast. For running the file, you need to use the run command in pwntools, and then do
	recvuntill(':') because you want to receive the code untill it asks for input. And then you
	send the payload by using the sendline command in pwntools. The output from running the
	pwntools is given below</p>

	<img src="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/images/narnia01.jpg"
	     class="helpful"> </img>
	<p class="walkthrough">
	<a
	    href="https://github.com/oriyocookie/CTFpwntoolsExploits/blob/master/overthewireNarnia/exploit_narnia0.py">Here's
	    the link to the script for Narnia0 
	</a> 
	</p>
	</div>

	<h3><strong>Level 1 to Level 2</strong></h3>
	<p class="walkthrough">This level mainly deals with the environment variables <br/><p>
	<img src="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/images/narnia1.jpg"
	     class="helpful"></img>
	<p class="walkthrough">As you can see from the code above, all this executable file does is
	call the environment variable EGG</p>
	<p class="walkthrough">We can easily change the environment value of EGG and call it to
	execute commands as you can see in the image below. So to complete this level we just need to put a shell
	code as the value for egg. You can find a bunch of shell codes at <a href="http://shell-storm.org/shellcode/">shell-storm </a></p>

	<img src="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/images/narnia11.jpg"
	     class="helpful"> </img>
	<p class="walkthrough">In order to write our python script we need to do just that. Our
	payload has to be export EGG="shellcode" and then we need to run the narnia1 executable
	after that. The output from my script is given below</p>

	<img src="https://oriyocookie.github.io/walkthrough/OverthewireNarnia/images/narnia12.jpg"
	     class="helpful"> </img>
	<p class="walkthrough">
	<a
	    href="https://github.com/oriyocookie/CTFpwntoolsExploits/blob/master/overthewireNarnia/exploit_narnia1.py">Here's
	    the link to the script for Narnia1 
	</a> 
	</p>


    </body>
    <footer></footer>
</html>

